/*! kodegenet 04-10-2014 */
var Kodegenet=Ember.Application.create({ready:function(){this.register("session:setting",Kodegenet.SettingController,{singleton:!0}),this.inject("controller","settings","session:setting"),this.inject("controller:setting","store","store:main")}});DS.RESTAdapter.reopen({namespace:"json"}),Kodegenet.Adapter=DS.RESTAdapter.extend(),Ember.Inflector.inflector.irregular("oppgave","oppgaver"),Kodegenet.Store=DS.Store.extend({adapter:"Kodegenet.Adapter"}),Kodegenet.UpdateAdapter=Kodegenet.Adapter.extend({namespace:"json/data"}),Kodegenet.PageAdapter=Kodegenet.Adapter.extend({namespace:"json/data"}),Kodegenet.SettingAdapter=Kodegenet.Adapter.extend({namespace:"json/data"}),Kodegenet.EventAdapter=Kodegenet.Adapter.extend({namespace:"json/data"}),Kodegenet.ApplicationController=Ember.ObjectController.extend({init:function(){console.log("Application Controller init");var a=this;this.store.find("setting").then(function(b){console.log(b.content),b.content.forEach(function(b){var c=b.id,d=b.get("settingsValue");console.log(b),console.log(c+" ::: "+d),a.settings.set(b.id,d)})})}}),Kodegenet.RenderSubchapterComponent=Ember.Component.extend({didInsertElement:function(){this._super(),this.append("TEST")}}),Kodegenet.ChapterController=Ember.ObjectController.extend({queryParams:["oppgave"],oppgaveObserver:function(){var a=this.get("oppgave");if(console.log("Oppgave: "),console.log(this.get("oppgave")),a){var b=this;setTimeout(function(){Ember.run.schedule("afterRender",this,function(){console.log("scrolling in after render"),b.scrollToSubchapter(a)},1)},1e3)}}.observes("oppgave"),scrollToSubchapter:function(a){this.set("selectedSubchapter",a);var b=a;if(console.log("scrolling to subchapter: "+a),console.log(b),b){var c=$("#"+b);c&&c.offset()&&$("body").scrollTop(c.offset().top-60)}}}),Kodegenet.ChapterIndexController=Ember.ObjectController.extend({actions:{visAlleOppgaverAction:function(){this.set("visAlleOppgaver",!0)},skjulAlleOppgaverAction:function(){this.set("visAlleOppgaver",!1)},visSlidesAction:function(){this.set("visSlides",!0)},skjulSlidesAction:function(){this.set("visSlides",!1)}}}),Kodegenet.ChapterIndexRoute=Ember.Route.extend({model:function(){return this.modelFor("chapter")}}),Kodegenet.ChapterRoute=Ember.Route.extend({model:function(a){return this.store.find("chapter",a.chapter_id)},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/chapter/"+b.get("id")),document.title=b.get("tittel")+" - Kodegenet"}}),Kodegenet.ChapterOppgaveController=Ember.ObjectController.extend({}),Kodegenet.ChapterOppgaveRoute=Ember.Route.extend({model:function(a){return console.log("ChapterOppgaveRoute: "),console.log(a),this.store.find("oppgave",a.oppgave_id)},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/oppgave"+b.get("id")),document.title=b.get("tittel")+" - Kodegenet"}}),Kodegenet.CourseController=Ember.ObjectController.extend({needs:["chapter","courses","chapterOppgave"],coursePopoverShowing:!1,chapterPopoverShowing:!1,subchapterPopoverShowing:!1,actions:{toggleCoursePopover:function(){this.set("chapterPopoverShowing",!1),this.set("subchapterPopoverShowing",!1),this.toggleProperty("coursePopoverShowing")},toggleChapterPopover:function(){this.set("coursePopoverShowing",!1),this.set("subchapterPopoverShowing",!1),this.toggleProperty("chapterPopoverShowing")},toggleSubchapterPopover:function(){this.set("chapterPopoverShowing",!1),this.set("coursePopoverShowing",!1),this.toggleProperty("subchapterPopoverShowing")},selectChapter:function(a){this.hidePopovers(),this.set("selectedSubchapter",null),this.transitionToRoute("chapter",a),this.scrollToTop()},selectCourse:function(a){this.hidePopovers(),this.set("selectedSubchapter",null),this.set("controllers.chapter.model",null),this.transitionToRoute("course",a),this.scrollToTop()},scrollToSubchapter:function(a){this.set("selectedSubchapter",a),this.hidePopovers();var b=a.get("id");if(b){var c=$("#"+b);if(c&&c.offset()){var d=$("html, body");d.animate({scrollTop:c.offset().top-60},"500","swing",function(){})}}}},scrollToTop:function(){var a=$("html, body");a.animate({scrollTop:100},"500","swing",function(){})},hidePopovers:function(){this.set("chapterPopoverShowing",!1),this.set("coursePopoverShowing",!1),this.set("subchapterPopoverShowing",!1)},coursePopoverShowingObserver:function(){this.get("coursePopoverShowing")?$("#coursePopover").removeClass("popnomore"):$("#coursePopover").addClass("popnomore")}.observes("coursePopoverShowing"),chapterPopoverShowingObserver:function(){this.get("chapterPopoverShowing")?$("#chapterPopover").removeClass("popnomore"):$("#chapterPopover").addClass("popnomore")}.observes("chapterPopoverShowing"),subchapterPopoverShowingObserver:function(){this.get("subchapterPopoverShowing")?$("#subchapterPopover").removeClass("popnomore"):$("#subchapterPopover").addClass("popnomore")}.observes("subchapterPopoverShowing")}),Kodegenet.CourseIndexController=Ember.ObjectController.extend({actions:{navigateToSubchapter:function(a,b){if(console.log("navigating to subchapter: "+b.get("id")),this.transitionToRoute("chapter",a),b){var c=this;setTimeout(function(){Ember.run.schedule("afterRender",this,function(){console.log("scrolling in after render"),c.scrollToSubchapter(b)},1)},250)}}},scrollToSubchapter:function(a){this.set("selectedSubchapter",a);var b=a.get("id");if(b){var c=$("#"+b);if(c&&c.offset()){var d=$("html, body");d.animate({scrollTop:c.offset().top-100},"500","swing",function(){})}}}}),Kodegenet.CourseIndexRoute=Ember.Route.extend({model:function(){return this.modelFor("course")}}),Kodegenet.CoursesCourseRoute=Ember.Route.extend({model:function(a){return this.store.find("course",a.course_id)},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/courses/"+b.get("id")),document.title="Kodegenet Kurs - "+b.get("title")}}),Kodegenet.CourseView=Ember.View.extend({didInsertElement:function(){$(window).scroll(function(){$(window).scrollTop()>100?$("#submenu").addClass("floatingTop"):$("#submenu").removeClass("floatingTop")})}}),Kodegenet.CoursesIndexController=Ember.ArrayController.extend({sortProperties:["sortIndex"],sortAscending:!0}),Kodegenet.CoursesIndexRoute=Ember.Route.extend({model:function(){return this.modelFor("courses")}}),Kodegenet.CoursesRoute=Ember.Route.extend({model:function(){return this.store.find("course")},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/courses"),document.title="Kursoversikt - Kodegenet"}}),Kodegenet.EpostlisteController=Ember.ObjectController.extend({init:function(){this.set("model",this.store.find("page","epostlister"))}}),Kodegenet.EpostlisteRoute=Ember.Route.extend({model:function(){return this.store.find("page","epostlister")},setupController:function(a){this._super(a),ga&&ga("send","pageview","/epostlister"),document.title="Epostlister - Kodegenet"}}),Kodegenet.HeaderController=Ember.ArrayController.extend({sortProperties:["sortIndex"],sortAscending:!0,init:function(){this._super();var a=[];this.store.find("page").then(function(b){b.forEach(function(b){var c=b.get("topMenu");console.log("topMenu: "+c+" :: "+b.get("id")),c&&a.pushObject(b)})});var b=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:a,sortProperties:this.sortProperties});this.set("content",b)}}),Ember.Handlebars.registerBoundHelper("dmy",function(a){if(null!==a){var b=moment(a);return b.format("DD-MM-YYYY")}}),Ember.Handlebars.registerBoundHelper("dmy_no",function(a){if(null!==a){var b=moment(a);return b.format("DD/MM/YYYY")}}),Ember.Handlebars.registerBoundHelper("rawhtml",function(a){return console.log("rawhtml: "+a),null!==a?new Handlebars.SafeString(a):void 0}),Ember.Handlebars.registerBoundHelper("markdown",function(a){var b=new Showdown.converter;return a?(Ember.run.schedule("afterRender",this,function(){console.log("scheduling to after render"),Rainbow.color()},200),new Handlebars.SafeString(b.makeHtml(a))):void 0}),Ember.Handlebars.registerBoundHelper("setting",function(a){if(null!==a){console.log("setting helper");var b=this.get("store").find("setting",a);return b.get("settingsValue")}}),Kodegenet.IndexController=Ember.ArrayController.extend({needs:["header"],contentObserver:function(){console.log("INDEX CONTROLLER OBSERVER");var a=this.get("content");a&&this.set("controllers.header.pages",a)}.observes("content.length")}),Kodegenet.IndexRoute=Ember.Route.extend({setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/"),document.title="Kodegenet Hjem"}}),Kodegenet.IndexController=Ember.ObjectController.extend({needs:["courses"],sortProperties:["publishedDate"],sortAscending:!1,numVisibleCourses:0,init:function(){var a=this;this.store.find("page","index").then(function(b){console.log("page received"),console.log(b),a.set("page",b)}),this.store.find("page","epostlister").then(function(b){a.set("epostliste",b)});var b=[];this.store.find("course").then(function(c){c.forEach(function(c){b.pushObject(c),c.get("visible")&&a.set("numVisibleCourses",a.get("numVisibleCourses")+1)})});var c=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:b,sortProperties:["sortIndex"]});a.set("courses",c)},indexColClassName:function(){return 1===this.get("numVisibleCourses")?"col-sm-5 col-sm-offset-4 col-md-5 col-md-offset-4":2===this.get("numVisibleCourses")?"col-sm-5 col-sm-offset-4 col-md-5 col-md-offset-1":"col-xs-12 col-sm-6 col-md-4 col-lg-4"}.property("numVisibleCourses"),sortedEvents:function(){var a=this.get("events"),b=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:a,sortProperties:["date"]});return b}.property("events.@each.date")}),Kodegenet.IndexRoute=Ember.Route.extend({model:function(){return Ember.RSVP.hash({updates:this.store.find("update"),events:this.store.find("event")})},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/"),document.title="Velkommen! - Kodegenet"}}),Kodegenet.KodeklubbEventRoute=Ember.Route.extend({setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/kodeklubb/event/"+b.get("id")),document.title="Event - "+b.get("name")+" - Kodegenet"}}),Kodegenet.KodeklubbIndexController=Ember.ObjectController.extend({sortProperties:["date"],sortAscending:!0,sortedEvents:function(){var a=this.get("events"),b=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:a,sortProperties:["date"]});return b}.property("events.@each.date")}),Kodegenet.KodeklubbRoute=Ember.Route.extend({model:function(){return Ember.RSVP.hash({page:this.store.find("page","lambertseter_kodeklubb"),events:this.store.find("event")})},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/kodeklubb"),document.title="Lambertseter Kodeklubb - Kodegenet"}}),Kodegenet.Chapter=DS.Model.extend({tittel:DS.attr("string"),content:DS.attr("string"),subchapters:DS.hasMany("subchapter",{async:!0}),slides:DS.attr("string"),kapittel:DS.attr("number"),oneliner:DS.attr("string"),intro:DS.attr("string"),slideUrl:function(){return"/reveal.html?ids%5B%5D="+this.get("id")}.property("id"),chapterTittel:function(){return this.get("kapittel")+". "+this.get("tittel")}.property("kapittel","tittel"),sortedSubchapters:function(){var a=this.get("subchapters"),b=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:a,sortProperties:["kapittel"]});return b}.property("subchapters.length")}),Kodegenet.Course=DS.Model.extend({chapters:DS.hasMany("chapter",{async:!0}),name:DS.attr("string"),title:DS.attr("string"),intro:DS.attr("string"),imageSrc:DS.attr("string"),content:DS.attr("string"),submenuContent:DS.attr("string"),shortIntro:DS.attr("string"),sortIndex:DS.attr("number"),visible:DS.attr("boolean"),largeImage:DS.attr("string"),sortedChapters:function(){var a=this.get("chapters"),b=Em.ArrayProxy.createWithMixins(Ember.SortableMixin,{content:a,sortProperties:["kapittel"]});return b}.property("chapters.length")}),Kodegenet.Event=DS.Model.extend({name:DS.attr("string"),content:DS.attr("string"),date:DS.attr("date"),ageGroup:DS.attr("string"),intro:DS.attr("string"),isVisible:DS.attr("boolean"),sted:DS.attr("string"),isInFuture:function(){var a=!1,b=this.get("date");if(b){var c=moment(),d=moment(b);a=d.diff(c)>0}return a}.property("date"),isInPast:Ember.computed.not("isInFuture")}),Kodegenet.Page=DS.Model.extend({tittel:DS.attr("string"),content:DS.attr("string"),visible:DS.attr("boolean"),topMenu:DS.attr("string"),route:DS.attr("string"),sortIndex:DS.attr("number")}),Kodegenet.Setting=DS.Model.extend({settingsValue:DS.attr("string"),settingsKey:DS.attr("string"),settingsLabel:DS.attr("string")}),Kodegenet.Subchapter=DS.Model.extend({tittel:DS.attr("string"),kapittel:DS.attr("number"),content:DS.attr("string"),screencastbox:DS.attr("string"),oneliner:DS.attr("string"),anchorid:function(){return"#"+this.get("id")}.property("id"),oppgaveTittel:function(){return this.get("kapittel")+". "+this.get("tittel")}.property("kapittel","tittel")}),Kodegenet.Update=DS.Model.extend({title:DS.attr("string"),content:DS.attr("string"),route:DS.attr("string"),publishedDate:DS.attr("string"),image:DS.attr("string")}),Kodegenet.OmRoute=Ember.Route.extend({model:function(){return this.store.find("page","om")},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/om"+b.get("id")),document.title="Om Oss - Kodegenet"}}),Kodegenet.PageRoute=Ember.Route.extend({model:function(a){return console.log("PAGE"),console.log(a),this.store.find("page",a.page_id)},setupController:function(a,b){this._super(a,b),ga&&ga("send","pageview","/page/"+b.get("id")),document.title=b.get("tittel")+" - Kodegenet"}}),Kodegenet.RevealFrameView=Ember.View.extend({tagName:"iframe",content:null,attributeBindings:["width","height","src"],width:700,height:500}),Kodegenet.Router=Ember.Router.extend({location:"history"}),Kodegenet.Router.map(function(){this.resource("index",{path:"/"},function(){}),this.resource("courses",{path:"/courses"},function(){this.resource("course",{path:"/:course_id"},function(){this.resource("chapter",{path:"/chapter/:chapter_id"},function(){this.route("oppgave",{path:"/oppgave/:oppgave_id"})})})}),this.resource("page",{path:"/page/:page_id"}),this.route("om"),this.resource("kodeklubb",{path:"/kodeklubb"},function(){this.route("event",{path:"/event/:event_id"})}),this.route("epostliste")}),Kodegenet.SettingController=Ember.Controller.extend({}),Kodegenet.ChapterMenuItemView=Ember.View.extend({templateName:"chapter-menu-item",isSelected:function(){return this.get("chapter.id")===this.get("controller.controllers.chapter.model.id")}.property("controller.controllers.chapter.model.id","chapter.id")});